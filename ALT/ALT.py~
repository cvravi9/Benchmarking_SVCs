# Importing the needed packages.
import numpy as np
import pandas as pd

# Reading the csv input file that is obtained after performing the following operations on the vcf file.
# Step 1 - 'cut -f 1-2, 9-11 Input-VCF-File > Output-VCF-File'
# Step 2 - 'sed '/^#/d' Output-VCF-File > Updated_Output-VCF-File'

# The first step is to selected the needed columns in the vcf file.
# The second step if to eliminate all lines that start with a '#'
dff = pd.read_csv("Final_Miracum_0.7.csv", sep = '\t', index_col= False)

# Naming the columns after importing the csv file.
dff.columns = ['CHROM', 'POS', 'REF', 'ALT']

# Concatinating the "CHROM" and "POS"
dff["CHROM_POS"] = dff['CHROM'].astype(str) + '-' + dff['POS'].astype(str)

# Dropping of the unnecessary columns and reorganising the columns.
dff = dff.drop(['CHROM', 'POS'], axis=1)
cols = dff.columns.tolist()
cols = cols[-1:] + cols[:-1]
dff = dff[cols]
print(dff)

# Saving the result into a csv file for plotting.
dff.to_csv('Selected_Miracum_0.7.csv', sep='\t', index = None)

# Merging the files based on CHROM-POS
Result = pd.merge(Selected_Miracum_0.4.csv, Selected_Miracum_0.7.csv, on="CHROM-POS")
First_Result = pd.merge(Result, Selected_Somatic_0.4.csv, on="CHROM-POS")
Second_Result = pd.merge(First_Result, Selected_Somatic_0.7.csv, on="CHROM-POS")
print(Second_Result)
